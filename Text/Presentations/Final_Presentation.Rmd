---
title: "Group 8 Final Presentation"
author: "Russell and Frances"
dataset: "Lake Quality"
date: "September 2022"
fontsize: 10pt
output: beamer_presentation

---


---
# Group 8

**Frances Smith**  
email: frances.j.smith.nz@gmail.com  
ORCHID ID: 0000-0002-5168-3134

**Russell Syder**  
email: russellsyder@gmail.com  
ORCHID ID: 0000-0002-4582-5909  

```{r frances, out.width = "40%", out.height = "30%", echo = FALSE}
knitr::include_graphics("Russell and Frances.png")
```


# Textual Description of the Dataset
Our dataset contains information from 3801 lakes in New Zealand. This dataset was extracted from Stats NZ.
https://www.stats.govt.nz/indicators/modelled-lake-water-quality/  

## Variables

For analysis we split the dataset into two main categories; the lake health variables and the lake dimension variable. The lake health variables measure as a whole give an indication of the "health" of an individual lake. The five lake health variables are Clarity, Ammoniacal Nitrogen, Total Nitrogen, Total phosphorus, and Chlorophyll-A. The lake dimension variables measure the dimensions of the lake. The three lake dimension variables are depth, area, perimeter. Additional variables that we examined were:  
- Region; which New Zealand region the lake was located in, and  
- Dominant landcover; split into four types; Exotic Forest, Native, Pastoral and Urban area. The category Urban area is applied if urban cover exceeds 15 percent of catchment area. Pastoral is applied if pastoral exceeds 25 percent of catchment area and not already assigned urban. The other three categories; Exotic forest, Native, or Other were assigned according to the largest land cover type by area, if not already assigned urban or pastoral.  

# Lake Health Variables

*Ammoniacal Nitrogen* is a form of nitrogen that supports algae and plant growth, but in large concentrations can be toxic to aquatic life. 
  
*Chlorophyll-a* is an organic molecule found in plant cells that allows plants to photosynthesize. The variable Chlorophyll-a is a measure of the concentration of phytoplankton biomass in milligrams per cubic metre. High concentrations of chlorophyll is a symptom of degraded water quality.  

*Total Phosphorus* is the sum of all phosphorus forms in the water. Large amounts of phosphorus in lakes can reduce dissolved oxygen in the water. This can cause low oxygen areas in the lake, where some aquatic life cannot survive.   

*Total Nitrogen* is the sum of all nitrogens found in the water. An excess of nitrogen in lakes can cause an increase in algae and plant growth, possibly depriving the lake of oxygen.  
  
*Clarity* is measured in Secchi depth. This is the maximum depth (in metres) a black and white Secchi disk is visible from the surface of the lake.  
  







# Exploratory Data Analysis

First we analysed the distribution of the lake health variables. Figure \ref{fig:correlationplot} shows the visualisation of the correlation matrix for the lake health variables.  

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
set.seed(300570258, kind = "Mersenne-Twister")

require(tinytex)
require(ggplot2)
require(ggthemes)
require(extrafont)
require(ggstance)
require(fitdistrplus)
require(ggcorrplot)
require(GGally)
require(ggExtra)
require(moments)
require(kable)
require(reshape2)
require(dplyr)
```

```{r functab, echo = FALSE}
MySummary2 <- function(x){
  return(c(
    length(x),
    min(x),
    median(x),
    max(x),
    var(x),
    mean(x),
    kurtosis(x), 
    skewness(x))
  )
}

lake <- read.csv("../../Data/modelled_lake_water_quality_altered.csv")
laketype <- as.factor(lake$nof_lake_type)

region <- as.factor(lake$region)
land <- as.factor(lake$dominant_landcover)
df <- data.frame(lake)
NH4N <- lake$median_NH4N_mg.L..1
CHLA <- lake$median_CHLA_mg.m.3
TP <- lake$median_TP_mg.m.3
TN <- lake$median_TN_mg.m.3
SECCHI <- lake$median_SECCHI_metre
depth <- lake$lake_depth
area <- lake$lake_area
peri <- lake$lake_perimeter

df1 <- data.frame(NH4N, CHLA, TP, TN, SECCHI)
df2 <- data.frame(land, NH4N, CHLA, TP, TN, SECCHI)
```


```{r correlationplot, fig.cap="Visualisation of the Correlation Matrix", fig.pos="center", echo=FALSE, warning = FALSE}
Ammoniacal_Nitrogen <- lake$median_NH4N_mg.L..1
Chlorophyll_A <- lake$median_CHLA_mg.m.3
Total_Phosphorus <- lake$median_TP_mg.m.3
Total_Nitrogen <- TN
Clarity <- SECCHI
df11 <- data.frame(Ammoniacal_Nitrogen, Chlorophyll_A, Total_Phosphorus, Total_Nitrogen, Clarity)
ggcorrplot(cor(df11), method = "circle", hc.order = TRUE, type = "lower")
```

# Exploratory Data Analysis

The pairs plot of the lake health and dimension variables, coloured by dominant landcover, is shown in figure \ref{fig:pairsplot}.  

```{r pairsplot, fig.cap="Pairs Plot", fig.pos="center", echo=FALSE, message = FALSE}
ggpairs(df11, aes(col=land, alpha=.5))
```

# Exploratory Data Analysis

Next, we wanted to compare the distribution of the lake health variables by types of dominant landcover. The side-by-side boxplots are shown in figure \ref{fig:boxx3}.  


```{r boxx3, fig.cap="Box Plots of Ammoniacal Nitrogen,  Chlorophyll-A, Total Phosphorus, Total Nitrogen and Clarity by Landcover", out.width = "80%", out.height = "60%", notch=FALSE, echo=FALSE, message=FALSE, warning=FALSE}

region <- as.factor(lake$region)
land <- as.factor(lake$dominant_landcover)
Ammoniacal_Nitrogen <- lake$median_NH4N_mg.L..1
Chlorophyll_A <- lake$median_CHLA_mg.m.3
Total_Phosphorus <- lake$median_TP_mg.m.3
Total_Nitrogen <- lake$median_TN_mg.m.3
Clarity <- lake$median_SECCHI_metre

df12 <- data.frame(land, Ammoniacal_Nitrogen, Chlorophyll_A, Total_Phosphorus, Total_Nitrogen, Clarity)
df12melt <- melt(df12,id.vars = "land" ,variable.name = "Measure")
ggplot(df12melt, aes(x=Measure, y=value)) +
geom_boxplot(aes(col=Measure), notch = TRUE) +
facet_grid(~ land) +
  scale_y_log10() +
theme(axis.text.x = element_text(size=7, angle=90, hjust=1),
legend.position = "none")
```


# Exploratory Data Analysis

Next we analysed the distribution of the lake health variables by region. The box plots of Ammoniacal Nitrogen by region is shown in figure \ref{fig:boxNH4N}.  

```{r boxNH4N, fig.cap = "Box Plot of Region and Ammoniacal Nitrogen", out.width = "80%", out.height = "60%", echo = FALSE, warnings = FALSE}
ggplot(df, aes(x=region, y=NH4N)) + 
    geom_boxplot(notch = TRUE, fill = "pink")+
  theme(axis.text.x = element_text(size=7, angle=90, hjust=1),
legend.position = "none")+
  xlab("Region")+
  ylab("Ammoniacal Nitrogen")+ 
  scale_x_discrete(guide = guide_axis(n.dodge=3))+
  scale_y_log10() +
  theme_tufte()
```

# Exploratory Data Analysis

The box plots of Chloorphyll-A by region is shown in figure \ref{fig:boxCHLA}.  

```{r boxCHLA, fig.cap = "Box Plot of Region and Chloropyll-A", out.width = "80%", out.height = "60%", echo = FALSE, warnings = FALSE}
ggplot(df, aes(x=region, y=CHLA)) + 
    geom_boxplot(notch = TRUE, fill = "lightgreen")+
  theme(axis.text.x = element_text(size=7, angle=90, hjust=1),
legend.position = "none")+
  xlab("Region")+
  ylab("Chloropyll-A")+ 
  scale_x_discrete(guide = guide_axis(n.dodge=3))+
  scale_y_log10() +
  theme_tufte()
```

# Exploratory Data Analysis

The box plots of Total Phosphorus by region is shown below in figure \ref{fig:boxTP}.  

```{r boxTP, fig.cap = "Box Plot of Region and Total Phosphorus", out.width = "80%", out.height = "60%", echo = FALSE, warnings = FALSE}
ggplot(df, aes(x=region, y=TP)) + 
    geom_boxplot(notch = TRUE, fill = "lightblue")+
  theme(axis.text.x = element_text(size=7, angle=90, hjust=1),
legend.position = "none")+
  xlab("Region")+
  ylab("Total Phosphorus")+ 
  scale_x_discrete(guide = guide_axis(n.dodge=3))+
  scale_y_log10() +
  theme_tufte()
```


# Exploratory Data Analysis

The box plots of Total Nitrogen by region is shown in figure \ref{fig:boxTN}.  

```{r boxTN, fig.cap = "Box Plot of Region and Total Nitrogen", out.width = "80%", out.height = "60%", echo = FALSE, warnings = FALSE}
ggplot(df, aes(x=region, y=TN)) + 
    geom_boxplot(notch = TRUE, fill = "orange")+
  theme(axis.text.x = element_text(size=7, angle=90, hjust=1),
legend.position = "none")+
  xlab("Region")+
  ylab("Total Nitrogen")+ 
  scale_x_discrete(guide = guide_axis(n.dodge=3))+
  scale_y_log10() +
  theme_tufte()
```

# Exploratory Data Analysis

Figure \ref{fig:boxSECCHI} shows the box plots of clarity by region. 


```{r boxSECCHI, fig.cap = "Box Plot of Region and Clarity", out.width = "80%", out.height = "60%", echo = FALSE, warnings = FALSE}
ggplot(df, aes(x=region, y=SECCHI)) + 
    geom_boxplot(notch = TRUE, fill = "violet")+
  theme(axis.text.x = element_text(size=7, angle=90, hjust=1),
legend.position = "none")+
  xlab("Region")+
  ylab("Clarity")+ 
  scale_x_discrete(guide = guide_axis(n.dodge=3))+
  scale_y_log10() +
  theme_tufte()
```

```{r scAN, fig.cap = "Pairs Plots of Ammoniacal Nitrogen and Dimension Variables", echo = FALSE}
p1 <- ggplot(df, aes(x=NH4N, y=depth)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Depth")+
  theme(legend.position="none")
p2 <- ggplot(df, aes(x=NH4N, y=area)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Area")+
  theme(legend.position="none")
p3 <- ggplot(df, aes(x=NH4N, y=peri)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Perimeter")+
  theme(legend.position="none")
  
ggMarginal(p1, type="boxplot")
ggMarginal(p2, type="boxplot")
ggMarginal(p3, type="boxplot")
```

```{r scAN, fig.cap = "Pairs Plots of Ammoniacal Nitrogen and Dimension Variables", echo = FALSE}
p1 <- ggplot(df, aes(x=NH4N, y=depth)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Depth")+
  theme(legend.position="none")
p2 <- ggplot(df, aes(x=NH4N, y=area)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Area")+
  theme(legend.position="none")
p3 <- ggplot(df, aes(x=NH4N, y=peri)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Perimeter")+
  theme(legend.position="none")
  
ggMarginal(p1, type="boxplot")
ggMarginal(p2, type="boxplot")
ggMarginal(p3, type="boxplot")
```

```{r scAN, fig.cap = "Pairs Plots of Ammoniacal Nitrogen and Dimension Variables", echo = FALSE}
p1 <- ggplot(df, aes(x=NH4N, y=depth)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Depth")+
  theme(legend.position="none")
p2 <- ggplot(df, aes(x=NH4N, y=area)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Area")+
  theme(legend.position="none")
p3 <- ggplot(df, aes(x=NH4N, y=peri)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Perimeter")+
  theme(legend.position="none")
  
ggMarginal(p1, type="boxplot")
ggMarginal(p2, type="boxplot")
ggMarginal(p3, type="boxplot")
```

```{r scAN, fig.cap = "Pairs Plots of Ammoniacal Nitrogen and Dimension Variables", echo = FALSE}
p1 <- ggplot(df, aes(x=NH4N, y=depth)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Depth")+
  theme(legend.position="none")
p2 <- ggplot(df, aes(x=NH4N, y=area)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Area")+
  theme(legend.position="none")
p3 <- ggplot(df, aes(x=NH4N, y=peri)) +
  geom_point() +
  xlab("Ammoniacal Nitrogen")+
  ylab("Perimeter")+
  theme(legend.position="none")
  
ggMarginal(p1, type="boxplot")
ggMarginal(p2, type="boxplot")
ggMarginal(p3, type="boxplot")
```

```{r scSECCHI, fig.cap = "Pairs Plots of Clarity and Dimension Variables", echo = FALSE}
p1 <- ggplot(df, aes(x=SECCHI, y=depth)) +
  geom_point() +
  xlab("Clarity")+
  ylab("Depth")+
  theme(legend.position="none")
p2 <- ggplot(df, aes(x=SECCHI, y=area)) +
  geom_point() +
  xlab("Clarity")+
  ylab("Area")+
  theme(legend.position="none")
p3 <- ggplot(df, aes(x=SECCHI, y=peri)) +
  geom_point() +
  xlab("Clarity")+
  ylab("Perimeter")+
  theme(legend.position="none")
  
ggMarginal(p1, type="boxplot")
ggMarginal(p2, type="boxplot")
ggMarginal(p3, type="boxplot")
```


# wat
Perform an EDA of the variables that we grouped together. At this point in time, we did not have a specific leading question that we were interested in. As such, we thought it would be prudent to make the goal of our EDA to extract as much interesting information from our data as  we could; then use the results to come up with leading questions.
RussBuss - Today at 1:00 PM
Once the EDA was performed we came up with some interesting questions that we could investigate further for the Preliminary Report. WE then conducted more analyses. The results of this were then refined.
The results of these were then refined into our Final Report.


# Problems

The dataset contained 12 lakes with no entry for dominant land cover. However in the description of the dataset by Stats NZ, it states all lakes have been categorised, and indicated these empty entries should be another category called 'other' that includes 'Gorse and/or Broom', 'Surface mines and dumps', 'Mixed exotic shrubland', and 'Transport infrastructure' so we have assigned these to the 'other' category.  

We also found one lake with no entry for region so we excluded this observation when analysing region with the lake health or dimension variables further.  



