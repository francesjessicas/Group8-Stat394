---
title: "Final Report"
author: "Russell and Frances"
date: "5th October 2022"
output: bookdown::pdf_document2
---

# Health of New Zealand Lakes 

## Introduction


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
set.seed(300570258, kind = "Mersenne-Twister")

require(tinytex)
require(ggplot2)
require(ggthemes)
require(extrafont)
require(ggstance)
require(fitdistrplus)
require(ggcorrplot)
require(GGally)
require(ggExtra)
require(moments)
require(kable)
require(reshape2)
require(nortest)
require(dplyr)
library(MASS)
library(klaR)
```


We are Russell and Frances and we form Group 8. Below are our pictures as well as our contact details and ORCID ID numbers.  
  
```{r frances, out.width = "40%", out.height = "30%", echo = FALSE}
knitr::include_graphics("../Presentations/Russell and Frances.png")
```
  
**Frances Smith**  
email: frances.j.smith.nz@gmail.com  
ORCHID ID: 0000-0002-5168-3134

**Russell Syder**  
email: russellsyder@gmail.com  
ORCHID ID: 0000-0002-4582-5909

### Introduction to our data
  
Our original dataset was extracted from Stats NZ.
https://www.stats.govt.nz/indicators/modelled-lake-water-quality/ 

We made some manipulations to the original dataset such as removing extraneous variables (like Date which was the same for every lake) or variables that we were not interested in. We also reshaped some aspects of the dataset so that the data would be easier to analyse. We checked for missing values; there were some for the categorical variables, which we dealt with as described below, but there were no missing values for the numerical variables so imputation was not necessary.  
  
Our final dataset contains information from 3802 lakes (exceeding one hectare) in New Zealand measured across 22 variables. Of these 22 variables we selected 10 that we would use for further analysis. They are as follows:  
  
*Ammoniacal Nitrogen* is a form of nitrogen that supports algae and plant growth, but in large concentrations can be toxic to aquatic life. This is measured in milligrams per litre. The national bottom line for this measure is 1.3mg/L, which none of the observations exceed. It acts as as measure of toxicity.  
  
*Chlorophyll-A* is an organic molecule found in plant cells that allows plants to photosynthesize. The variable Chlorophyll-A is a measure of the concentration of phytoplankton biomass in milligrams per cubic metre. High concentrations of chlorophyll is a symptom of degraded water quality. The national bottom line for this measure is 12.  

*Total Phosphorus* is the sum of all phosphorus forms in the water, including phosphorus bound to sediment. Large amounts of phosphorus in lakes can reduce dissolved oxygen in the water. This can cause low oxygen areas in the lake, where some aquatic life cannot survive. Total Phosphorus is measured in milligrams per cubic metre and has a national bottom line of 50mg/m3.  

*Total Nitrogen* is the sum of all nitrogens found in the water, including organic nitrogen from plant tissue. An excess of nitrogen in lakes can cause an increase in algae and plant growth, possibly depriving the lake of oxygen. Total Nitrogen is measured in milligrams per cubic metre and the national bottom line for stratified lakes is 750mg/m3, and for polymictic lakes is 800mg/m3.  
  
*Clarity* is measured in Secchi depth. This is the maximum depth (in metres) a black and white Secchi disk is visible from the surface of the lake.  

*Area* is the surface area of the lake measured in metres squared.  

*Perimeter* is the overall perimeter of the lake, in metres.  

*Lake Depth* is the maximum depth of the lake measured in metres.  
  
*Dominant Landcover* is split into four types; Exotic Forest, Native, Pastoral and Urban area. There are 12 lakes with no entry for Dominant Landcover, however in the description of the dataset by Stats NZ, it states all lakes have been categorised, and indicated these empty entries should be another category called 'Other' that includes 'Gorse and/or Broom', 'Surface mines and dumps', 'Mixed exotic shrubland', and 'Transport infrastructure' so we have assigned these to the Other category. The category Urban area is applied if urban cover exceeds 15 percent of catchment area. Pastoral is applied if pastoral landcover exceeds 25 percent of catchment area, if the lake has not already been assigned urban. The other three categories; Exotic forest, Native, or Other were assigned according to the largest land cover type by area, if not already assigned urban or pastoral.  
  
*Regions* in this dataset are; Auckland, Bay of Plenty, Canterbury, Gisborne, Hawke's Bay, Whanganui, Marlborough, Northland, Otago, Southland, Taranaki, Tasman, Waikato, Wellington and West Coast. Each lake corresponds to the region it is located in.

Upon first examining our data we thought that it would be prudent to group certain similar variables together for analysis. Specifically, the 4 variables that gave a measure of the levels of a given substance in a lake, and additionally clarity, we grouped as the "Lake Health variables" as for all of them, high levels of any of these variables can indicate poor lake health, with the exception of clarity, where, in general, higher values indicate better lake health.  

We also grouped together lake Area, Perimeter, and Depth and classified this group as the Lake Dimension variables.  

### Leading Question

Our leading question was; What are some statistics that we can produce that may be beneficial for informing restorative actions that improve the health of lakes in New Zealand?  

To investigate this we came up with the following questions;  

- Are there any particular regions that have poor lake health?  

- Do the Lake Health variables predict one another?  

- How can we model the Lake Dimension variables?  

- Do any types of Dominant Landcover have poorer lake health than others?

## Methodology

To answer these questions, we will conduct the following investigations:  

- An Exploratory Data Analysis on the Lake Health, Lake Dimension, Region and Dominant Landcover variables, which will consist of:  

  - Univariate analysis of the Lake Health and Lake Dimension variables  
  
  - Bivariate analysis with each of these four types of variables, specifically:  
  
    - Relationship between the Lake Health and Lake Dimension variables, and  
    
    - Comparisons of the Lake Health and Lake Dimension variables by Region and Dominant Landcover  

- Tests for difference in means of the Lake Health variables by Dominant Landcover  

- Principal Component Analysis on the Lake Health variables  

- Factor Analysis on the Lake Health Variables  

- Linear Discriminant Analysis on the Lake Health variables by Dominant Landcover  

The latter four analyses will be in our Results section.  

### Exploratory Data Analysis

```{r functab, echo = FALSE}
MySummary2 <- function(x){
  return(c(
    length(x),
    min(x),
    quantile(x, .25),
    median(x),
    quantile(x, .75),
    max(x),
    sd(x),
    mean(x),
    kurtosis(x), 
    skewness(x))
  )
}
```

#### Univariate Analysis of the Lake Health Variables

Table \ref{tab:laketable} shows the summary statistics for each of these three measures. 

```{r laketable, echo = FALSE}
lake <- read.csv("../../Data/modelled_lake_water_quality_altered.csv")
laketype <- as.factor(lake$nof_lake_type)

region <- as.factor(lake$region)
land <- as.factor(lake$dominant_landcover)
df <- data.frame(lake)
NH4N <- lake$median_NH4N_mg.L..1
CHLA <- lake$median_CHLA_mg.m.3
TP <- lake$median_TP_mg.m.3
TN <- lake$median_TN_mg.m.3
SECCHI <- lake$median_SECCHI_metre

df1 <- data.frame(NH4N, CHLA, TP, TN, SECCHI)
df2 <- data.frame(land, NH4N, CHLA, TP, TN, SECCHI)
tab <- apply(df1, MySummary2, MARGIN = 2)
tab <- as.table(tab)

rownames(tab) <- c('Sample Size','Minimum','1st Quantile', 'Median', '3rd Quantile', 'Maximum', 'Standard Deviation', 'Mean', 'Kurtosis', 'Skewness')
colnames(tab) <- c('Ammoniacal Nitrogen', 'Chloropyll-A', 'Phosphorus', "Nitrogen", "Clarity")
knitr::kable(tab, caption = "Table of Sample Statistics", "simple")
```


Figure \ref{fig:nh4nhist} shows the distribution of Ammoniacal Nitrogen. The fitted normal distribution (in red) differs significantly from the smoothed histogram (purple). The smoothed histogram is more skewed and the mode is well below the mean. The median 0.0096 and mean 0.0120. Table \ref{tab:laketable} confirms this with a skewness of 2.0339. The kurtosis is 8.1158, indicating the distribution of Ammoniacal Nitrogen has heavy tails. There are two extreme values, at around 0.06 mg per litre. There is a large amount of observations around the first quantile, 0.0073 mg per litre. 

```{r nh4nhist, fig.cap="Histogram of Ammoniacal Nitrogen", fig.pos="center", echo=FALSE}
ggplot(df, aes(x=NH4N)) +
  geom_histogram(aes(y=..density..),
                 bins = nclass.FD(unlist(NH4N)),
                 col="black", fill="white") +
  xlab("Observations of Ammonical Nitrogen") +
  ylab("Histogram, smoothed histogram, and estimated normal density") +
  geom_density(kernel="epanechnikov", size=2, col="purple", alpha=.1, adjust = 2) +
  stat_function(fun = "dnorm", args=list(mean=mean(NH4N), sd=sd(NH4N)),
                col="red", size=2, alpha=.5) +
   geom_vline(xintercept = mean(NH4N), col="red") +
  geom_segment(aes(x=mean(NH4N)-sd(NH4N),
                   y=15,
                   xend=mean(NH4N)+sd(NH4N),
                   yend=15), col="red", alpha=.3) +
  geom_boxplot(aes(y=-10), width=7, notch = TRUE)+
  theme_tufte()
```
  

Figure \ref{fig:chlahist} shows the distribution of Chlorophyll-A. We can see the fitted normal distribution differs slightly from the smoothed histogram. Table \ref{tab:laketable} shows the median is 3.9482 and the mean is 4.6093. The kurtosis is 18.3408, indicating the distribution of Chlorophyll-A is very heavy tailed, and the skewness is 2.5484, indicating the distribution is right skewed. A small proportion of the lakes exceeded the national bottomline of 12mg per cubic metre. 

```{r chlahist, fig.cap="Histogram of Chlorophyll-A", fig.pos="center", echo=FALSE}
ggplot(df, aes(x=CHLA)) +
  geom_histogram(aes(y=..density..),
                 bins = nclass.FD(unlist(CHLA)),
                 col="black", fill="white") +
  xlab("Observations of Chlorophyll-A") +
  ylab("Histogram, smoothed histogram, and estimated normal density") +
  geom_density(kernel="epanechnikov", size=2, col="purple", alpha=.1, adjust = 2) +
  stat_function(fun = "dnorm", args=list(mean=mean(CHLA), sd=sd(CHLA)),
                col="red", size=2, alpha=.5) +
   geom_vline(xintercept = mean(CHLA), col="red") +
  geom_vline(xintercept = 12, col="blue") +
  geom_segment(aes(x=mean(CHLA)-sd(CHLA),
                   y=0.02,
                   xend=mean(CHLA)+sd(CHLA),
                   yend=0.02), col="red", alpha=.3) +
  geom_boxplot(aes(y=-0.01), width=0.01, notch = TRUE)+
  theme_tufte()
```

Figure \ref{fig:tphist} shows the distribution of Total Phosphorus. The fitted normal distribution (red) fits quite well to the smoothed histogram (purple), although the kurtosis is very high, 26.2763. We would expect the kurtosis of a normally distributed variable to be close to 3 and with a skewness of 0, however the sample statistics of Total Phosphorus show the kurtosis much larger than 3 and the skewness 2.8722. This indicates the tails of this distribution are much heavier than a normal distribution, and it is right skewed. Table \ref{tab:laketable} shows the median of Total Phosphorus is 17.8966 mg per cubic meter, and the mean is 18.7206 mg per cubic meter. Few of the lakes exceeded the national bottomline of 50mg per cubic metre. 


```{r tphist, fig.cap="Histogram of Total Phosphorus", fig.pos="center", echo=FALSE}
ggplot(df, aes(x=TP)) +
  geom_histogram(aes(y=..density..),
                 bins = nclass.FD(unlist(TP)),
                 col="black", fill="white") +
  xlab("Observations of Total Phosphorus") +
  ylab("Histogram, smoothed histogram, and estimated normal density") +
  geom_density(kernel="epanechnikov", size=2, col="purple", alpha=.1, adjust = 2) +
  stat_function(fun = "dnorm", args=list(mean=mean(TP), sd=sd(TP)),
                col="red", size=2, alpha=.5) +
  geom_vline(xintercept = mean(TP), col="red") +
  geom_vline(xintercept = 50, col="blue") +
  geom_segment(aes(x=mean(TP)-sd(TP),
                   y=0.007,
                   xend=mean(TP)+sd(TP),
                   yend=0.007), col="red", alpha=.3) +
  geom_boxplot(aes(y=-.005), width=.003, notch = TRUE)+
  theme_tufte()
```
  
  
Figure \ref{fig:TNhist} shows the distribution of Total Nitrogen. The fitted normal distribution (in red) differs significantly from the smoothed histogram (purple). The smoothed histogram is more skewed and the mode is well below the mean. The median 416.7044 and mean 505.8606. Table \ref{tab:laketable} confirms this with a skewness of 1.0799. The kurtosis is 3.5463, indicating the distribution of Total Nitrogen has reasonable tails. A significant proportion of the observations exceed the higher of the two national bottomlines, of 800mg per cubic metre. 

```{r TNhist, fig.cap="Histogram of Total Nitrogen", fig.pos="center", echo=FALSE}
ggplot(df, aes(x=TN)) +
  geom_histogram(aes(y=..density..),
                 bins = nclass.FD(unlist(TN)),
                 col="black", fill="white") +
  xlab("Observations of Total Nitrogen") +
  ylab("Histogram, smoothed histogram, and estimated normal density") +
  geom_density(kernel="epanechnikov", size=2, col="purple", alpha=.1, adjust = 2) +
  stat_function(fun = "dnorm", args=list(mean=mean(TN), sd=sd(TN)),
                col="red", size=2, alpha=.5) +
   geom_vline(xintercept = mean(TN), col="red") +
  geom_vline(xintercept = 800, col="blue") +
  geom_segment(aes(x=mean(TN)-sd(TN),
                   y=0.00035,
                   xend=mean(TN)+sd(TN),
                   yend=0.00035), col="red", alpha=.3) +
  geom_boxplot(aes(y=-.0005), width=.0003, notch = TRUE)+
  theme_tufte()
```
  
Figure \ref{fig:SECCHIhist} shows the distribution of Clarity. The fitted normal distribution (in red) differs from the smoothed histogram (purple). The smoothed histogram is slightly asymmetrical but not skewed, with a median of 4.4677 and a mean of 4.4510. Table \ref{tab:laketable} confirms this with a skewness of 0.2342. The kurtosis is 1.9983, indicating the distribution of Clarity has slightly lighter tails than a normal distribution. These statistics indicate the distribution of Clarity is close to normal. 
  
```{r SECCHIhist, fig.cap="Histogram of Clarity (in metres)", fig.pos="center", echo=FALSE}
ggplot(df, aes(x=SECCHI)) +
  geom_histogram(aes(y=..density..),
                 bins = nclass.FD(unlist(SECCHI)),
                 col="black", fill="white") +
  xlab("Observations of Clarity in metres") +
  ylab("Histogram, smoothed histogram, and estimated normal density") +
  geom_density(kernel="epanechnikov", size=2, col="purple", alpha=.1, adjust = 2) +
  stat_function(fun = "dnorm", args=list(mean=mean(SECCHI), sd=sd(SECCHI)),
                col="red", size=2, alpha=.5) +
   geom_vline(xintercept = mean(SECCHI), col="red") +
  geom_segment(aes(x=mean(SECCHI)-sd(SECCHI),
                   y=0.05,
                   xend=mean(SECCHI)+sd(SECCHI),
                   yend=0.05), col="red", alpha=.3) +
  geom_boxplot(aes(y=-.05), width=.03, notch = TRUE)+
  theme_tufte()

```  

We have made Cullen and Frey plots for Ammoniacal Nitrogen, Chlorophyll-A, Total Phosphorus, Total Nitrogen and Clarity, each with 1000 bootstrapped observations, shown in orange. 

In figure \ref{fig:cfNH4N}, the Cullen and Frey graph of Ammoniacal Nitrogen, we can see the observed kurtosis and square of skewness was much larger than a normal distribution. The observation and all bootstrapped values were within the Beta distribution region, indicating the distribution of Ammoniacal Nitrogen in New Zealand lakes may follow a Beta distribution. 

Figure \ref{fig:cfCHLA} shows the Cullen and Frey graph of Chlorophyll-A. The observed kurtosis and square of skewness were both much larger than we would expect for a normal distribution. The observed value and the bootstrapped observations lie on or just below the line all lognormal distributions lie on. This could tell us the distribution of Chlorophyll-A in New Zealand lakes could follow a lognormal distribution.

The Cullen and Frey graph of Total Phosphorus is shown in figure \ref{fig:cfTP}. The observed kurtosis and square of skewness were larger than both Ammoniacal Nitrogen and Chlorophyll-A. Similar to the Cullen and Frey graph of Chlorophyll-A, the observed value and bootstrapped observations seem to lie close to the line that contains all lognormal distributions. However, very few of the bootstrapped observations lie on this line, indicating Total Phosphorus in New Zealand lakes likely does not follow a lognormal, or any other distribution illustrated on this graph. 

The Cullen and Frey graph of Total Nitrogen is shown in figure \ref{fig:cfTN}. The observed value and the boostrapped observations all lie within the grey area suggesting that Total Nitrogen follows a Beta distribution. 

The Cullen and Frey graph of Clarity is shown in figure \ref{fig:cfSECCHI}. The observed value and bootstrapped values of the skewness and kurtosis of Clarity lies within the area all beta distributions exist within, and very close to the Uniform distributions, indicating the distribution of Clarity could be Uniform or Beta.  


```{r cfNH4N, fig.cap = "Cullen and Frey Graph of Ammoniacal Nitrogen", echo = FALSE}
descdist(NH4N, boot = 1000)
```

```{r cfCHLA, fig.cap = "Cullen and Frey Graph of Chlorophyll-A", echo = FALSE}
descdist(CHLA, boot = 1000)
```

```{r cfTP, fig.cap = "Cullen and Frey Graph of Total Phosphorus", echo = FALSE}
descdist(TP, boot = 1000)
```
  
    
```{r cfTN, fig.cap = "Cullen and Frey Graph of Total Nitrogen", echo = FALSE}
descdist(TN, boot = 1000)
```
  
```{r cfSECCHI, fig.cap = "Cullen and Frey Graph of Clarity", echo = FALSE}
descdist(SECCHI, boot = 1000)
```

We believe, based on the Cullen and Frey graphs, none of these distributions are normal. We confirmed this with Anderson Darlings tests of normality. 

Table \ref{tab:adexnh4n} shows the test statistic and p-value from the Anderson-Darling test on Ammoniacal Nitrogen levels in lakes with predominantly Exotic Forest landcover. The null hypothesis for this test is that the distribution of Ammoniacal Nitrogen in lakes with exotic forest landcover is Gaussian, and the alternative hypothesis is that the distribution is not normal. The test statistic for this test is 12.2369, and the p-value is 3.7e-24. As the p-value is very small, we can reject the null hypothesis and conclude the distribution of Ammoniacal Nitrogen in lakes with predominantly exotic forest landcover is not normal. Therefore, we cannot use a one-way ANOVA test. We have also done this test on the other landcover types with similar results. For Native landcover, the test statistic was 208.5689 and the p-value was 3.7e-24. For "other" landcover, the test statistic was 1.1297 and the p-value was 3.5818e-3. For Pastoral landcover the test statistic is 50.8314 and the p-value was 3.7e-24. Finally, for Urban landcover, the test statistic was 3.7878 and the p-value was 1.5945. This information is shown in tables \ref{tab:adnatnh4n}, \ref{tab:adothnh4n}, \ref{tab:adpastnh4n} and \ref{tab:adurbnh4n}. 

```{r adexnh4n, fig.cap = "Anderson-Darling Test for Normality of Ammoniacal Nitrogen in Lakes with Predominantly Exotic Forest Landcover", fig.pos = "center", echo = FALSE}
land <- as.factor(lake$dominant_landcover)
df2 <- data.frame(land, NH4N, CHLA, TP, TN, SECCHI)
A <- filter(df2, land == "Exotic forest")
A = A[,-1]
A <- data.frame(A)
tab <- ad.test(A$NH4N)
tstatr <- tab$statistic
tstatr1 <- round(tstatr, 4)
pvalr <- tab$p.value
pvalr1 <- format(pvalr, scientific = TRUE)
A <- filter(df2, land == "Native")
A = A[,-1]
A <- data.frame(A)
tab <- ad.test(A$NH4N)
tstatr <- tab$statistic
tstatr2 <- round(tstatr, 4)
pvalr <- tab$p.value
pvalr2 <- format(pvalr, scientific = TRUE)
A <- filter(df2, land == "Other")
A = A[,-1]
A <- data.frame(A)
tab <- ad.test(A$NH4N)
tstatr <- tab$statistic
tstatr3 <- round(tstatr, 4)
pvalr <- tab$p.value
pvalr3 <- format(pvalr, scientific = TRUE)
A <- filter(df2, land == "Pastoral")
A = A[,-1]
A <- data.frame(A)
tab <- ad.test(A$NH4N)
tstatr <- tab$statistic
tstatr4 <- round(tstatr, 4)
pvalr <- tab$p.value
pvalr4 <- format(pvalr, scientific = TRUE)
A <- filter(df2, land == "Urban area")
A = A[,-1]
A <- data.frame(A)
tab <- ad.test(A$NH4N)
tstatr <- tab$statistic
tstatr5 <- round(tstatr, 4)
pvalr <- tab$p.value
pvalr5 <- format(pvalr, scientific = TRUE)
tab <- matrix(c(tstatr1, pvalr1, tstatr2, pvalr2, tstatr3, pvalr3, tstatr4, pvalr4, tstatr5, pvalr5), nrow = 2, byrow = FALSE)
tabr <- as.table(tab)
rownames(tabr) <- c("Test Statistic", "P-Value")
colnames(tabr) <- c("Exotic Forest", "Native", "Other", "Pastoral", "Urban Area")
knitr::kable(tabr, caption = "Anderson-Darling Test Statistic and P-value for Ammoniacal Nitrogen by Dominant Landcover")
```

## Results

- test for difference in means health/land + pairwise tests
- PCA
- FA

### Linear Discriminant Analysis and Factor Analysis

After finishing our Preliminary Report we also looked at ways we could implement Factor Analysis (FA) and Linear Discriminant Analysis (LDA) with our data.
  
#### Linear Discriminant Analysis  
For LDA, we wanted to see if there was potential to implement LDA if there was information loss. As such, we attempted to predict which Dominant Landcover a lake was, based on the Lake Health Variables.

Reminder -  the categories that dominant landcover can take on are: Pastoral, Native, Urban area, Exotic forest, and Other
  
We first scaled the Lake Health Variables. We then randomly created training and test sets with 70% of the data in the training set and 30% in the test set. We then fit the LDA model using the train data. The output was shown below.



```{r, echo = FALSE}
lake3 <- select(lake, dominant_landcover, median_TN_mg.m.3, median_CHLA_mg.m.3, median_SECCHI_metre, median_TP_mg.m.3, median_NH4N_mg.L..1)
lake4 <- filter(lake3, dominant_landcover == "Pastoral" | dominant_landcover == "Native")

lake3[2:6] <- scale(lake3[2:6])

set.seed(123)
sample <- sample(c(TRUE, FALSE), nrow(lake3), replace=TRUE, prob=c(0.7,0.3))

train <- lake3[sample, ]
test <- lake3[!sample, ]

model1 <- lda(dominant_landcover~., data=train)
model1

```
From the Prior Probabilities we see that Pastoral Landcover and Native Landcover each explain about 46% of the prior probabilities in the training set.  
  
  From examining the coefficients of the linear discriminants, it seems that Total nitrogen (TN) impacts the first linear discriminant the most (-0.8323.). 

Examining the proportion of traces we see that the LD1 accounts for approximately 91 percent of the separation. LD2 and LD3 account for approximately 4.8 and 3.5 percent of the separation respectively. The remainder is explained by LD4.

We produced a partition plot to examine the separation.  
  
  
```{r, echo = FALSE}
lake3$dominant_landcover<- as.factor(lake3$dominant_landcover)
partimat(dominant_landcover ~ ., data=lake3, method="lda")

```

It is difficult to get much useful information from the the Partition Plot. What we can see is that there is a reasonable number of errors. We can also see is that most of the data seems to be in two of the partitions and some of the partitions have no observations in them.  
  
  
```{r echo=FALSE, include=FALSE}
predicted <- predict(model1, test)
mean(predicted$class==test$dominant_landcover)

```
  
  
  We then looked at the accuracy of the model and found that the model had approximately 73% accuracy (with seed = 123). We were reasonably happy with this. However, one thing that bothered us was the partition plot and how difficult it was to decipher and the fact the prior probabilities for two of our classes (Pastoral Landcover and Native Landcover) were so much higher than the others. We decided to investigate just these two classes as they accounted for about 93% of the observations in our sample.
  
  
  

```{r, echo = FALSE}

lake4[2:6] <- scale(lake4[2:6])

set.seed(123)
sample <- sample(c(TRUE, FALSE), nrow(lake4), replace=TRUE, prob=c(0.7,0.3))

train <- lake4[sample, ]
test <- lake4[!sample, ]


lake4$dominant_landcover<- as.factor(lake4$dominant_landcover)

model <- lda(dominant_landcover~., data=train)
model

predicted <- predict(model, test)


lake5 <- sample(lake4, size = 100, replace = TRUE )

```
  
  In the second LDA both groups had prior probabilities of 0.5 (this is because the train happened to split them with an equal number of observations of 1242 each (seed = 123)).    
<br />

```{r, echo = FALSE}
lake4$dominant_landcover<- as.factor(lake4$dominant_landcover)
partimat(dominant_landcover ~ ., data=lake4, method="lda")

```
  
The Partition plot while not any easier to interpret, sorted groups more appropriately and did not have unused partitions. We still see plenty of errors. The individual graphs give error rates between 0.218 and 0.29.

  
```{r, include =FALSE}
mean(predicted$class==test$dominant_landcover)
```

The accuracy was only slightly better at 76.7%.  
  
  The implications of this LDA investigation suggest are that Dominant Landcover may be an indicator of the levels of lake health variables in a given lake. Therefore, if we know whether a lake has native or pastoral landcover, this could give us an indication on the health of a lake. It also means that in the case that the Dominant Landcover observation is lost for a lake, the value may be able to be imputed (with a note mentioning the imputation) with some level of accuracy by using the values from the Lake Health variables. 



## Discussion

- WHAT DOES IT MEEEAAAAAANNNNNNN
- problems
  - clarity  (not always possible as you may just have a shallow lake).  



## Bibliography

- I have some references from research into health variables and where data from 
- APA referencing


data: https://www.stats.govt.nz/indicators/modelled-lake-water-quality/ 




